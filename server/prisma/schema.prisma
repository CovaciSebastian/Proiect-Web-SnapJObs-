generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String    @id @default(cuid())
  email     String    @unique
  name      String?
  password  String?
  role      String    @default("STUDENT") // STUDENT sau EMPLOYER
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  // Câmpuri noi pentru OAuth
  provider  String    @default("email") // 'email' sau 'google'
  googleId  String?   @unique // ID-ul unic de la Google (câmpul 'sub')

  // Câmpuri din modelul vechi ce pot fi utile, dar le las comentate momentan
  // phone      String?
  // city       String?
  // university String?
  // about      String?
  // title      String?

  jobs         Job[]
  applications Application[]

  @@map("users")
}

model Job {
  id          Int      @id @default(autoincrement())
  employer_id String
  employer    User     @relation(fields: [employer_id], references: [id])
  title       String
  company     String
  type        String   // 'eveniment', 'online', 'fizic'
  salary      String
  location    String
  lat         Float?
  lng         Float?
  date        String?
  description String
  image_url   String?
  created_at  DateTime @default(now())

  applications Application[]

  @@map("jobs")
}

model Application {
  id         Int      @id @default(autoincrement())
  job_id     Int
  job        Job      @relation(fields: [job_id], references: [id], onDelete: Cascade)
  student_id String
  student    User     @relation(fields: [student_id], references: [id])
  applied_at DateTime @default(now())

  @@unique([job_id, student_id])
  @@map("applications")
}